<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exponent Rules Practice</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .solution-box {
            background-color: #f9fafb;
            border: 1px solid #e5e7eb;
            transition: all 0.3s ease-in-out;
        }
        .fraction {
            display: inline-flex;
            flex-direction: column;
            align-items: center;
            vertical-align: middle;
            margin: 0 0.2em;
            line-height: 1.2;
        }
        .numerator {
            border-bottom: 2px solid black;
            padding: 0 0.4em;
        }
        .denominator {
            padding: 0 0.4em;
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen p-4">

    <main class="bg-white rounded-2xl shadow-lg w-full max-w-2xl">
        <div class="p-8 border-b border-gray-200">
            <h1 class="text-3xl font-bold text-gray-800">Exponent Rules Practice</h1>
            <p class="text-gray-600 mt-2">Check your answer after each problem. Use '^' for exponents.</p>
        </div>

        <div id="quizContainer" class="p-8">
            <!-- The quiz question will be dynamically generated and inserted here -->
        </div>

    </main>

    <script>
        const quizContainer = document.getElementById('quizContainer');
        let allQuestions = [];
        let currentQuestionIndex = 0;

        const getRandomInt = (min, max) => Math.floor(Math.random() * (max - min + 1)) + min;

        function generateQuestions() {
            allQuestions = [];
            
            // --- Evaluation Questions (Generate 4) ---
            for (let i = 0; i < 4; i++) {
                const type = i % 4;
                if (type === 0) {
                    const base = getRandomInt(2, 5);
                    allQuestions.push({
                        text: `(-${base})<sup>2</sup>`,
                        answer: (base ** 2).toString(),
                        solutionSteps: [`The exponent '2' applies to both the negative sign and the base number ${base}.`, `An even exponent on a negative base results in a positive answer.`, `(-${base}) * (-${base}) = ${base**2}`]
                    });
                } else if (type === 1) {
                    const base = getRandomInt(2, 4);
                    allQuestions.push({
                        text: `-${base}<sup>4</sup>`,
                        answer: (-(base ** 4)).toString(),
                        solutionSteps: [`The exponent '4' only applies to the base number ${base}, not the negative sign.`, `Calculate the power first: ${base}<sup>4</sup> = ${base**4}.`, `Then apply the negative sign: -${base**4}`]
                    });
                } else if (type === 2) {
                    const pow = getRandomInt(15, 51) * 2 + 1; // odd
                    allQuestions.push({
                        text: `(-1)<sup>${pow}</sup>`,
                        answer: '-1',
                        solutionSteps: [`The base is -1.`, `An odd exponent on a negative base results in a negative answer.`, `(-1) raised to any odd power is always -1.`]
                    });
                } else {
                    const pow = getRandomInt(15, 51) * 2; // even
                    allQuestions.push({
                        text: `(-1)<sup>${pow}</sup>`,
                        answer: '1',
                        solutionSteps: [`The base is -1.`, `An even exponent on a negative base results in a positive answer.`, `(-1) raised to any even power is always 1.`]
                    });
                }
            }

            // --- Simplification Questions (Generate 4) ---
             for (let i = 0; i < 4; i++) {
                const type = i % 4;
                if (type === 0) { // Product Rule
                    const c1 = getRandomInt(2, 6); const p1 = getRandomInt(2, 5);
                    const c2 = getRandomInt(2, 6); const p2 = getRandomInt(2, 5);
                    allQuestions.push({
                        text: `${c1}x<sup>${p1}</sup> &middot; ${c2}x<sup>${p2}</sup>`,
                        answer: `${c1*c2}x^${p1+p2}`,
                        solutionSteps: [`<strong>Product Rule (a<sup>m</sup> * a<sup>n</sup> = a<sup>m+n</sup>):</strong> When multiplying terms with the same base, add the exponents.`, `Multiply the coefficients: ${c1} &middot; ${c2} = ${c1*c2}.`, `Add the exponents of x: x<sup>${p1}</sup> &middot; x<sup>${p2}</sup> = x<sup>${p1}+${p2}</sup> = x<sup>${p1+p2}</sup>.`, `Combine them: ${c1*c2}x<sup>${p1+p2}</sup>.`]
                    });
                } else if (type === 1) { // Quotient Rule
                    const c_d = getRandomInt(2, 5); const p_d = getRandomInt(2, 5); const q_d = getRandomInt(2, 5);
                    const c_mult = getRandomInt(2, 5); const p_add = getRandomInt(1, 4); const q_add = getRandomInt(1, 4);
                    const c_n = c_d * c_mult; const p_n = p_d + p_add; const q_n = q_d + q_add;
                    allQuestions.push({
                        text: `<div class="fraction"><span class="numerator">${c_n}x<sup>${p_n}</sup>y<sup>${q_n}</sup></span><span class="denominator">${c_d}x<sup>${p_d}</sup>y<sup>${q_d}</sup></span></div>`,
                        answer: `${c_mult}x^${p_add}y^${q_add}`,
                        solutionSteps: [`<strong>Quotient Rule (a<sup>m</sup> / a<sup>n</sup> = a<sup>m-n</sup>):</strong> When dividing terms with the same base, subtract the exponents.`, `Divide the coefficients: ${c_n} &divide; ${c_d} = ${c_mult}.`, `Subtract the exponents for x: x<sup>${p_n}</sup> / x<sup>${p_d}</sup> = x<sup>${p_n}-${p_d}</sup> = x<sup>${p_add}</sup>.`, `Subtract the exponents for y: y<sup>${q_n}</sup> / y<sup>${q_d}</sup> = y<sup>${q_n}-${q_d}</sup> = y<sup>${q_add}</sup>.`, `Combine them: ${c_mult}x<sup>${p_add}</sup>y<sup>${q_add}</sup>.`]
                    });
                } else if (type === 2) { // Power Rule
                    const c = getRandomInt(2, 4); const p1 = getRandomInt(2, 4); const p2 = getRandomInt(2, 4); const pow = getRandomInt(2, 3);
                    allQuestions.push({
                        text: `(${c}x<sup>${p1}</sup>y<sup>${p2}</sup>)<sup>${pow}</sup>`,
                        answer: `${c**pow}x^${p1*pow}y^${p2*pow}`,
                        solutionSteps: [`<strong>Power Rule ((ab)<sup>m</sup> = a<sup>m</sup>b<sup>m</sup> and (a<sup>n</sup>)<sup>m</sup> = a<sup>nm</sup>):</strong> Distribute the outer exponent to each factor inside the parentheses.`, `Apply the power to the coefficient: ${c}<sup>${pow}</sup> = ${c**pow}.`, `Multiply the exponents for x: (x<sup>${p1}</sup>)<sup>${pow}</sup> = x<sup>${p1}*${pow}</sup> = x<sup>${p1*pow}</sup>.`, `Multiply the exponents for y: (y<sup>${p2}</sup>)<sup>${pow}</sup> = y<sup>${p2}*${pow}</sup> = y<sup>${p2*pow}</sup>.`, `Combine them: ${c**pow}x<sup>${p1*pow}</sup>y<sup>${p2*pow}</sup>.`]
                    });
                } else { // Combo Rule
                     const c_n1 = getRandomInt(2, 4); const p_n1 = 1; const q_n1 = getRandomInt(5, 9);
                    const p_n2 = getRandomInt(2, 4); const q_n2 = 1;
                    const c_d = c_n1; const p_d = p_n1 + p_n2; const q_d = getRandomInt(2, 5);
                    const pow = 2; const final_q = (q_n1 + q_n2 - q_d) * pow;
                    allQuestions.push({
                        text: `(&nbsp;<div class="fraction"><span class="numerator">${c_n1}xy<sup>${q_n1}</sup> &middot; x<sup>${p_n2}</sup>y</span><span class="denominator">${c_d}x<sup>${p_d}</sup>y<sup>${q_d}</sup></span></div>&nbsp;)<sup>${pow}</sup>`,
                        answer: `y^${final_q}`,
                        solutionSteps: [`<strong>Step 1 (Simplify Numerator):</strong> First, simplify inside the parentheses by multiplying the terms in the numerator.`, `<code>${c_n1}x<sup>1</sup>y<sup>${q_n1}</sup> &middot; x<sup>${p_n2}</sup>y<sup>1</sup> = ${c_n1}x<sup>${1+p_n2}</sup>y<sup>${q_n1+1}</sup></code>`, `<strong>Step 2 (Simplify Fraction):</strong> Now, divide the numerator by the denominator.`, `<code>(${c_n1}/${c_d}) = 1</code>. <code>(x<sup>${p_d}</sup>/x<sup>${p_d}</sup>) = x<sup>0</sup> = 1</code>. <code>(y<sup>${q_n1+1}</sup>/y<sup>${q_d}</sup>) = y<sup>${q_n1+1-q_d}</sup></code>`, `<strong>Step 3 (Apply Power Rule):</strong> Apply the outer exponent to the simplified term.`, `(y<sup>${q_n1+1-q_d}</sup>)<sup>${pow}</sup> = y<sup>${(q_n1+1-q_d)*pow}</sup> = y<sup>${final_q}</sup>.`]
                    });
                }
            }
        }

        function startQuiz() {
            currentQuestionIndex = 0;
            generateQuestions();
            renderCurrentQuestion();
        }

        function renderCurrentQuestion() {
            if (currentQuestionIndex >= allQuestions.length) {
                quizContainer.innerHTML = `<div class="text-center">
                    <h2 class="text-2xl font-bold text-gray-800">Practice Complete!</h2>
                    <p class="mt-2 text-gray-600">You've finished all the questions for this session.</p>
                    <button id="startOverBtn" class="mt-6 bg-blue-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-blue-700">Start Over with New Questions</button>
                </div>`;
                document.getElementById('startOverBtn').addEventListener('click', startQuiz);
                return;
            }

            const q = allQuestions[currentQuestionIndex];
            quizContainer.innerHTML = `
                <div class="mb-4">
                    <h2 class="text-xl font-semibold text-gray-700">Question ${currentQuestionIndex + 1} of ${allQuestions.length}</h2>
                    <p class="mt-1 text-gray-600">${q.answer.match(/[a-z]/) ? 'Fully simplify the expression using only positive exponents.' : 'Evaluate the expression.'}</p>
                </div>
                <div class="text-center text-3xl my-8">${q.text}</div>
                <div class="flex flex-col sm:flex-row items-center justify-center gap-4">
                    <input type="text" id="userAnswer" class="p-3 border border-gray-300 rounded-lg text-center text-lg w-full sm:w-auto" autofocus>
                    <button id="checkBtn" class="bg-green-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-green-700 w-full sm:w-auto">Check</button>
                </div>
                <div id="feedbackContainer" class="mt-6"></div>
            `;

            document.getElementById('checkBtn').addEventListener('click', checkAnswer);
            document.getElementById('userAnswer').addEventListener('keypress', e => { if (e.key === 'Enter') checkAnswer(); });
        }
        
        const normalizeAnswer = (str) => {
            let s = (str || '').replace(/\s+/g, '').replace(/\*/g, '').toLowerCase();
            if (s.match(/[a-z]/)) {
                const coeffMatch = s.match(/^-?\d+/);
                const coeff = coeffMatch ? coeffMatch[0] : '1';
                const vars = (s.match(/[a-z]\^?-?\d*/g) || []).sort().join('');
                if (coeff === '1' && vars) return vars;
                return coeff + vars;
            }
            return s;
        };
        
        function checkAnswer() {
            const userAnswerRaw = document.getElementById('userAnswer').value.trim();
            const feedbackContainer = document.getElementById('feedbackContainer');
            const q = allQuestions[currentQuestionIndex];
            const isCorrect = normalizeAnswer(userAnswerRaw) === normalizeAnswer(q.answer);

            let feedbackHTML = `<div class="p-4 rounded-lg solution-box">`;
            if (isCorrect) {
                feedbackHTML += `<h3 class="text-lg font-bold text-green-700">Correct!</h3>`;
            } else {
                feedbackHTML += `<h3 class="text-lg font-bold text-red-700">Not quite.</h3>
                                 <p class="mt-1">Your answer was <strong>${userAnswerRaw || "empty"}</strong>. The correct answer is <strong>${q.answer}</strong>.</p>`;
            }
            
            feedbackHTML += `<div class="mt-4"><h4 class="font-semibold">Here's how to solve it:</h4><div class="mt-2 space-y-2 text-sm text-gray-700">${q.solutionSteps.join('<br>')}</div></div>`;
            feedbackHTML += `</div><div class="text-center mt-6">
                                <button id="nextBtn" class="bg-blue-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-blue-700">Next Question</button>
                             </div>`;
            
            feedbackContainer.innerHTML = feedbackHTML;
            document.getElementById('checkBtn').disabled = true;
            document.getElementById('userAnswer').disabled = true;
            document.getElementById('nextBtn').addEventListener('click', nextQuestion);
            document.getElementById('nextBtn').focus();
        }

        function nextQuestion() {
            currentQuestionIndex++;
            renderCurrentQuestion();
        }
        
        document.addEventListener('DOMContentLoaded', startQuiz);
    </script>
</body>
</html>

