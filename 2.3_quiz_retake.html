<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Algebra Word Problem Practice</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .quiz-container {
            transition: all 0.3s ease-in-out;
        }
        .result-item.correct {
            background-color: #f0fdf4;
            border-left-color: #22c55e;
        }
        .result-item.incorrect {
            background-color: #fef2f2;
            border-left-color: #ef4444;
        }
        .question-prefix {
            font-weight: 500;
            flex-shrink: 0;
        }
        .answer-field {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        .answer-field input {
            width: 100%;
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen p-4">

    <main class="bg-white rounded-2xl shadow-lg w-full max-w-4xl quiz-container">
        <div class="p-8 border-b border-gray-200">
            <h1 class="text-3xl font-bold text-gray-800">2.4 Quiz Word Problem Retake</h1>
            <p class="text-gray-600 mt-2">Translate each situation into an algebraic equation and then solve. Four-Function Calculator Allowed.</p>
        </div>

        <div id="quizContainer" class="p-8">
            <!-- The quiz form will be dynamically generated and inserted here -->
        </div>

        <!-- Results Section -->
        <div id="resultsSection" class="hidden p-8">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">Quiz Results</h2>
            <div id="score" class="text-xl mb-6 font-semibold"></div>
            <div id="detailedResults" class="space-y-4"></div>
             <div class="mt-8 text-center flex flex-col sm:flex-row justify-center items-center gap-4">
                <button id="retakeQuizBtn" class="bg-gray-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-gray-700 focus:outline-none focus:ring-4 focus:ring-gray-300 transition-transform transform hover:scale-105 w-full sm:w-auto">
                    Try This Quiz Again
                </button>
                <button id="generateNewBtn" class="bg-blue-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-4 focus:ring-blue-300 transition-transform transform hover:scale-105 w-full sm:w-auto">
                    Generate New Quiz
                </button>
            </div>
        </div>
    </main>

    <script>
        const quizContainer = document.getElementById('quizContainer');
        const resultsSection = document.getElementById('resultsSection');
        const scoreElement = document.getElementById('score');
        const detailedResultsElement = document.getElementById('detailedResults');
        const retakeQuizBtn = document.getElementById('retakeQuizBtn');
        const generateNewBtn = document.getElementById('generateNewBtn');

        let currentQuestions = [];

        // --- UTILITY FUNCTIONS ---
        const getRandomInt = (min, max) => Math.floor(Math.random() * (max - min + 1)) + min;
        const toWords = (num) => {
             const words = ["zero", "one", "two", "three", "four", "five", "six", "seven", "eight", "nine", "ten"];
             return words[num] || num.toString();
        };

        // --- QUESTION GENERATORS ---
        function generateFractionProblem() {
            const den = getRandomInt(3, 8);
            const num = getRandomInt(2, den - 1);
            const solution = den * getRandomInt(5, 20);
            const result = (num * solution) / den;
            const denWords = ["", "", "halves", "thirds", "fourths", "fifths", "sixths", "sevenths", "eighths"];

            return {
                id: 'q_frac',
                text: `${toWords(num).charAt(0).toUpperCase() + toWords(num).slice(1)} ${denWords[den]} of a number is ${result}. What is the number?`,
                fields: [{ id: 'q_frac_ans', label: 'The number is' }],
                answers: [solution.toString()]
            };
        }

        function generateConsecutiveIntProblem() {
            const start = getRandomInt(10, 50);
            const sum = start + (start + 1);
            return {
                id: 'q_consec',
                text: `The sum of two consecutive integers is ${sum}. What are the numbers?`,
                fields: [{ id: 'q_consec_1', label: 'First number' }, { id: 'q_consec_2', label: 'Second number' }],
                answers: [start.toString(), (start + 1).toString()]
            };
        }

        function generatePerimeterProblem() {
            const width = getRandomInt(5, 15);
            const diff = getRandomInt(2, 10);
            const length = width + diff;
            const perimeter = 2 * (length + width);
            const area = length * width;
            return {
                id: 'q_perim',
                text: `The length of a rectangle is ${diff} inches longer than the width. The perimeter is ${perimeter} inches. Find the length, width, and area of the rectangle.`,
                fields: [
                    { id: 'q_perim_w', label: 'Width (in)' },
                    { id: 'q_perim_l', label: 'Length (in)' },
                    { id: 'q_perim_a', label: 'Area (inÂ²)' }
                ],
                answers: [width.toString(), length.toString(), area.toString()]
            };
        }

        function generateSimpleSystemProblem() {
            const names = ["Jen", "Mike", "Sarah", "Chris"];
            const items = [["apples", "oranges"], ["pens", "pencils"], ["shirts", "shorts"]];
            const selected = items[getRandomInt(0, items.length - 1)];
            const name = names[getRandomInt(0, names.length - 1)];

            const item2Count = getRandomInt(5, 15);
            const diff = getRandomInt(2, 5);
            const item1Count = item2Count + diff;
            const total = item1Count + item2Count;

            return {
                id: 'q_sys',
                text: `${name} bought ${diff} more ${selected[0]} than ${selected[1]}. They bought ${total} items in total. How many ${selected[1]} did ${name} buy?`,
                fields: [{ id: 'q_sys_ans', label: `Number of ${selected[1]}` }],
                answers: [item2Count.toString()]
            };
        }

        function generateLinearCostProblem() {
            const names = ["Gavin", "Maria", "Liam", "Zoe"];
            const items = ["gigabytes of data", "miles driven", "hours of service"];
            
            const name = names[getRandomInt(0, names.length - 1)];
            const item = items[getRandomInt(0, items.length-1)];

            const flatCost = (getRandomInt(20, 50) + 0.5).toFixed(2);
            const perItemCost = getRandomInt(3, 10);
            const quantity = getRandomInt(5, 15);
            const totalCost = (parseFloat(flatCost) + perItemCost * quantity).toFixed(2);

            return {
                id: 'q_cost',
                text: `Under their plan, ${name} pays a flat cost of $${flatCost} per month and $${perItemCost} per ${item.split(' ')[0]}. They want to keep the bill at $${totalCost} per month. How many ${item} can they use?`,
                fields: [{ id: 'q_cost_ans', label: `Number of ${item}` }],
                answers: [quantity.toString()]
            };
        }
        
        // --- CORE QUIZ LOGIC ---
        function generateAndRenderQuiz() {
            currentQuestions = [
                generateFractionProblem(),
                generateConsecutiveIntProblem(),
                generatePerimeterProblem(),
                generateSimpleSystemProblem(),
                generateLinearCostProblem()
            ];
            renderQuizForm(currentQuestions);
            quizContainer.classList.remove('hidden');
            resultsSection.classList.add('hidden');
            window.scrollTo(0, 0);
        }

        function renderQuizForm(questions) {
            const prefixes = ['a.', 'b.', 'c.', 'd.', 'e.'];
            const questionsHTML = questions.map((q, i) => `
                <div class="flex flex-col md:flex-row md:items-start gap-4">
                    <div class="md:w-2/3 text-gray-700">
                        <p><span class="question-prefix mr-2">${prefixes[i]}</span>${q.text}</p>
                    </div>
                    <div class="w-full md:w-1/3 space-y-3">
                        ${q.fields.map(field => `
                            <div class="answer-field">
                                <label for="${field.id}" class="text-sm font-medium text-gray-600">${field.label}:</label>
                                <input type="text" id="${field.id}" name="${field.id}" class="p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition">
                            </div>
                        `).join('')}
                    </div>
                </div>
            `).join('<hr class="my-6">');

            quizContainer.innerHTML = `
                <form id="quizForm">
                    <div class="space-y-6">${questionsHTML}</div>
                    <div class="mt-10 text-center">
                        <button type="submit" class="bg-green-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-green-700 focus:outline-none focus:ring-4 focus:ring-green-300 transition-transform transform hover:scale-105">
                            Grade My Quiz
                        </button>
                    </div>
                </form>
            `;
            
            document.getElementById('quizForm').addEventListener('submit', gradeQuiz);
        }

        function gradeQuiz(event) {
            event.preventDefault();
            let score = 0;
            let resultsHTML = '';
            
            currentQuestions.forEach(q => {
                const userAnswers = q.fields.map(field => document.getElementById(field.id).value.trim());
                
                // For multi-answer questions, sort to ignore order.
                const sortedUserAnswers = [...userAnswers].sort();
                const sortedCorrectAnswers = [...q.answers].sort();
                
                const isCorrect = JSON.stringify(sortedUserAnswers) === JSON.stringify(sortedCorrectAnswers);

                if (isCorrect) score++;

                resultsHTML += `
                    <div class="result-item border-l-4 p-4 rounded-md ${isCorrect ? 'correct' : 'incorrect'}">
                        <div class="font-semibold text-gray-800">${q.text}</div>
                        <p class="mt-2 text-sm">Your answer(s): <span class="font-medium ${isCorrect ? 'text-green-700' : 'text-red-700'}">${userAnswers.join(', ') || '<i>No answer</i>'}</span></p>
                        ${!isCorrect ? `<p class="mt-1 text-sm">Correct answer(s): <span class="font-medium text-green-700">${q.answers.join(', ')}</span></p>` : ''}
                    </div>
                `;
            });

            const totalQuestions = currentQuestions.length;
            const percentage = Math.round((score / totalQuestions) * 100);
            let scoreColor = percentage >= 80 ? 'text-green-600' : (percentage >= 60 ? 'text-yellow-600' : 'text-red-600');

            scoreElement.innerHTML = `Your Score: <span class="${scoreColor}">${score} out of ${totalQuestions} (${percentage}%)</span>`;
            detailedResultsElement.innerHTML = resultsHTML;

            quizContainer.classList.add('hidden');
            resultsSection.classList.remove('hidden');
            window.scrollTo(0, 0);
        }

        // --- EVENT LISTENERS ---
        retakeQuizBtn.addEventListener('click', () => {
            renderQuizForm(currentQuestions);
            resultsSection.classList.add('hidden');
            quizContainer.classList.remove('hidden');
        });

        generateNewBtn.addEventListener('click', generateAndRenderQuiz);
        document.addEventListener('DOMContentLoaded', generateAndRenderQuiz);
    </script>
</body>
</html>

