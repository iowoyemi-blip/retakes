<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Algebra Word Problem Practice</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .solution-box {
            background-color: #f9fafb;
            border: 1px solid #e5e7eb;
        }
        code {
            font-family: 'Courier New', Courier, monospace;
            background-color: #f3f4f6;
            padding: 2px 6px;
            border-radius: 4px;
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen p-4">

    <main class="bg-white rounded-2xl shadow-lg w-full max-w-2xl">
        <div class="p-8 border-b border-gray-200">
            <h1 class="text-3xl font-bold text-gray-800">Algebra Word Problem Practice</h1>
            <p class="text-gray-600 mt-2">Check your answer after each problem. Four-Function Calculator Allowed.</p>
        </div>

        <div id="quizContainer" class="p-8">
            </div>

    </main>

    <script>
        const quizContainer = document.getElementById('quizContainer');
        let allQuestions = [];
        let currentQuestionIndex = 0;
        let score = 0; // NEW: Variable to track the score

        const getRandomInt = (min, max) => Math.floor(Math.random() * (max - min + 1)) + min;
        const toWords = (num) => ["zero", "one", "two", "three", "four", "five", "six", "seven", "eight", "nine", "ten"][num] || num.toString();
        const shuffle = (arr) => arr.sort(() => Math.random() - 0.5);

        function generateQuestions() {
            // This function is unchanged and generates 7 unique problems.
            //<editor-fold desc="Full Question Generation Logic">
            const fractionProblem = () => {
                const den = getRandomInt(3, 8); const num = getRandomInt(2, den - 1); const solution = den * getRandomInt(5, 20); const result = (num * solution) / den; const denWords = ["", "", "halves", "thirds", "fourths", "fifths", "sixths", "sevenths", "eighths"];
                return { text: `${toWords(num).charAt(0).toUpperCase() + toWords(num).slice(1)} ${denWords[den]} of a number is ${result}. What is the number?`, fields: [{ id: 'ans', label: 'The number is' }], answers: [solution.toString()], solutionSteps: [ `<strong>Step 1: Set up the equation.</strong> Let 'n' be the number. "${toWords(num)} ${denWords[den]}" translates to <code>(${num}/${den})</code>.`, `Equation: <code>(${num}/${den})n = ${result}</code>`, `<strong>Step 2: Solve for n.</strong> Multiply both sides by the reciprocal of the fraction, which is <code>(${den}/${num})</code>.`, `<code>n = ${result} * (${den}/${num})</code>`, `<code>n = ${solution}</code>` ] };
            };
            const consecutiveIntProblem = () => {
                const start = getRandomInt(10, 50); const sum = start + (start + 1);
                return { text: `The sum of two consecutive integers is ${sum}. What are the numbers?`, fields: [{ id: 'ans1', label: 'First number' }, { id: 'ans2', label: 'Second number' }], answers: [start.toString(), (start + 1).toString()], solutionSteps: [ `<strong>Step 1: Define variables.</strong> Let the first integer be 'n'. Since they are consecutive, the second integer is 'n + 1'.`, `<strong>Step 2: Set up the equation.</strong> Their sum is ${sum}.`, `<code>n + (n + 1) = ${sum}</code>`, `<strong>Step 3: Solve for n.</strong> Combine like terms: <code>2n + 1 = ${sum}</code>.`, `Subtract 1 from both sides: <code>2n = ${sum - 1}</code>.`, `Divide by 2: <code>n = ${start}</code>.`, `<strong>Step 4: Find the second number.</strong> The second number is n + 1, so <code>${start} + 1 = ${start + 1}</code>.` ] };
            };
            const perimeterProblem = () => {
                const width = getRandomInt(5, 15); const diff = getRandomInt(2, 10); const length = width + diff; const perimeter = 2 * (length + width); const area = length * width;
                return { text: `The length of a rectangle is ${diff} inches longer than the width. The perimeter is ${perimeter} inches. Find the length, width, and area.`, fields: [{ id: 'ans_w', label: 'Width (in)' }, { id: 'ans_l', label: 'Length (in)' }, { id: 'ans_a', label: 'Area (inÂ²)' }], answers: [width.toString(), length.toString(), area.toString()], solutionSteps: [ `<strong>Step 1: Set up equations.</strong> Let W be width and L be length.`, `<code>L = W + ${diff}</code>`, `<code>2L + 2W = ${perimeter}</code> (Perimeter formula)`, `<strong>Step 2: Solve for W using substitution.</strong> Substitute the first equation into the second:`, `<code>2(W + ${diff}) + 2W = ${perimeter}</code>`, `<code>2W + ${2*diff} + 2W = ${perimeter}</code> => <code>4W + ${2*diff} = ${perimeter}</code>`, `<code>4W = ${perimeter - 2*diff}</code> => <code>W = ${width}</code>`, `<strong>Step 3: Solve for L.</strong> <code>L = ${width} + ${diff} = ${length}</code>.`, `<strong>Step 4: Calculate Area.</strong> Area = L * W => <code>${length} * ${width} = ${area}</code>.` ] };
            };
            const simpleSystemProblem = () => {
                const item2Count = getRandomInt(5, 15); const diff = getRandomInt(2, 5); const item1Count = item2Count + diff; const total = item1Count + item2Count;
                 return { text: `Jen bought ${diff} more apples than oranges. She bought ${total} items in total. How many oranges did Jen buy?`, fields: [{ id: 'ans_o', label: `Number of oranges` }], answers: [item2Count.toString()], solutionSteps: [ `<strong>Step 1: Define variables.</strong> Let 'a' be apples and 'o' be oranges.`, `<strong>Step 2: Set up the system.</strong>`, `<code>a = o + ${diff}</code> (more apples than oranges)`, `<code>a + o = ${total}</code> (total items)`, `<strong>Step 3: Solve using substitution.</strong>`, `<code>(o + ${diff}) + o = ${total}</code>`, `<code>2o + ${diff} = ${total}</code> => <code>2o = ${total - diff}</code>`, `<code>o = ${item2Count}</code>` ] };
            };
            const linearCostProblem = () => {
                const flatCost = (getRandomInt(20, 50) + 0.5).toFixed(2); const perItemCost = getRandomInt(3, 10); const quantity = getRandomInt(5, 15); const totalCost = (parseFloat(flatCost) + perItemCost * quantity).toFixed(2);
                return { text: `Under his cell phone plan, Gavin pays a flat cost of $${flatCost} per month and $${perItemCost} per gigabyte. He wants to keep his bill at $${totalCost} per month. How many gigabytes of data can he use?`, fields: [{ id: 'ans_gb', label: `Gigabytes of data` }], answers: [quantity.toString()], solutionSteps: [ `<strong>Step 1: Set up the equation.</strong> Let 'g' be the number of gigabytes.`, `The total cost is the flat cost plus the per-gigabyte cost.`, `<code>${flatCost} + ${perItemCost}g = ${totalCost}</code>`, `<strong>Step 2: Solve for g.</strong>`, `Subtract the flat cost: <code>${perItemCost}g = ${totalCost} - ${flatCost}</code> => <code>${perItemCost}g = ${(totalCost - flatCost).toFixed(2)}</code>`, `Divide by the per-item cost: <code>g = ${(totalCost - flatCost).toFixed(2)} / ${perItemCost}</code>`, `<code>g = ${quantity}</code>` ] };
            };
            const wordedFractionProblem = () => {
                const problemSet = [ { d1: 6, d2: 3, d3: 2, s: 1 }, { d1: 8, d2: 4, d3: 2, s: 2 }, { d1: 10, d2: 5, d3: 2, s: 3 }, { d1: 12, d2: 4, d3: 3, s: 1 } ]; const { d1, d2, d3, s } = problemSet[getRandomInt(0, problemSet.length - 1)]; const fractionWords = {2: 'one half', 3: 'one third', 4: 'one fourth', 5: 'one fifth', 6: 'one sixth', 8: 'one eighth', 10: 'one tenth', 12: 'one twelfth'}; const text = `${fractionWords[d1].charAt(0).toUpperCase() + fractionWords[d1].slice(1)} of a number increased by ${fractionWords[d2]} equals ${fractionWords[d3]}. Find the number.`;
                return { text: text, fields: [{ id: 'ans', label: 'The number is' }], answers: [s.toString()], solutionSteps: [ `<strong>Step 1: Translate the sentence into an equation.</strong> Let 'n' be the number.`, `<code>(1/${d1})n + (1/${d2}) = (1/${d3})</code>`, `<strong>Step 2: Isolate the variable term.</strong> Subtract <code>1/${d2}</code> from both sides.`, `<code>(1/${d1})n = (1/${d3}) - (1/${d2})</code>`, `To subtract the fractions, find a common denominator: <code>(1/${d1})n = (${d2}/${d2*d3}) - (${d3}/${d2*d3})</code> => <code>(1/${d1})n = (${d2-d3}/${d2*d3})</code>`, `<strong>Step 3: Solve for n.</strong> Multiply both sides by <code>${d1}</code>.`, `<code>n = ${d1} * (${d2-d3}/${d2*d3})</code> => <code>n = ${s}</code>` ] };
            };
            const variableOnBothSidesProblem = () => {
                const solution = getRandomInt(5, 15); const multiplier = getRandomInt(2, 4); const multiplierWords = ["", "one", "twice", "three times", "four times"]; const constant2 = getRandomInt(1, 10); const constant1 = (multiplier - 1) * solution - constant2; const text = `A number plus ${constant1} equals ${multiplierWords[multiplier]} the number minus ${constant2}. Find the number.`;
                return { text: text, fields: [{ id: 'ans', label: 'The number is' }], answers: [solution.toString()], solutionSteps: [ `<strong>Step 1: Translate the sentence into an equation.</strong> Let 'n' be the number.`, `<code>n + ${constant1} = ${multiplier}n - ${constant2}</code>`, `<strong>Step 2: Move variables to one side.</strong> Subtract 'n' from both sides.`, `<code>${constant1} = ${multiplier-1}n - ${constant2}</code>`, `<strong>Step 3: Move constants to the other side.</strong> Add <code>${constant2}</code> to both sides.`, `<code>${constant1 + constant2} = ${multiplier-1}n</code>`, `<strong>Step 4: Solve for n.</strong> Divide by <code>${multiplier-1}</code>.`, `<code>n = ${solution}</code>` ] };
            };
            //</editor-fold>
            allQuestions = shuffle([
                fractionProblem(), consecutiveIntProblem(), perimeterProblem(), simpleSystemProblem(),
                linearCostProblem(), wordedFractionProblem(), variableOnBothSidesProblem()
            ]);
        }

        function startQuiz() {
            score = 0; // MODIFIED: Reset score at the start
            currentQuestionIndex = 0;
            generateQuestions();
            renderCurrentQuestion();
        }

        function renderCurrentQuestion() {
            // MODIFIED: This block now displays the final score at the end of the quiz.
            if (currentQuestionIndex >= allQuestions.length) {
                const totalQuestions = allQuestions.length;
                const percentage = Math.round((score / totalQuestions) * 100);
                let scoreColor = percentage >= 80 ? 'text-green-600' : (percentage >= 60 ? 'text-yellow-600' : 'text-red-700');

                quizContainer.innerHTML = `
                    <div class="text-center">
                        <h2 class="text-2xl font-bold text-gray-800">Practice Complete!</h2>
                        <p class="text-xl my-4">Your Final Score:</p>
                        <p class="text-5xl font-bold ${scoreColor}">${score} out of ${totalQuestions}</p>
                        <p class="text-xl mt-2 font-semibold ${scoreColor}">(${percentage}%)</p>
                        <button id="startOverBtn" class="mt-8 bg-blue-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-blue-700">Start Over with New Questions</button>
                    </div>`;
                document.getElementById('startOverBtn').addEventListener('click', startQuiz);
                return;
            }

            const q = allQuestions[currentQuestionIndex];
            const fieldsHTML = q.fields.map(f => `
                <div class="flex items-center gap-2">
                    <label for="${f.id}" class="font-medium whitespace-nowrap">${f.label}:</label>
                    <input type="text" id="${f.id}" class="p-2 border border-gray-300 rounded-lg text-lg w-full">
                </div>
            `).join('');

            quizContainer.innerHTML = `
                <div class="mb-4">
                    <h2 class="text-xl font-semibold text-gray-700">Question ${currentQuestionIndex + 1} of ${allQuestions.length}</h2>
                </div>
                <p class="text-xl my-8">${q.text}</p>
                <div class="flex flex-col gap-4 max-w-sm mx-auto">${fieldsHTML}</div>
                <div class="text-center mt-6">
                     <button id="checkBtn" class="bg-green-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-green-700">Check</button>
                </div>
                <div id="feedbackContainer" class="mt-6"></div>
            `;

            document.getElementById('checkBtn').addEventListener('click', checkAnswer);
            q.fields.forEach(f => {
                document.getElementById(f.id).addEventListener('keypress', e => { if (e.key === 'Enter') checkAnswer(); });
            });
        }
        
        function checkAnswer() {
            const feedbackContainer = document.getElementById('feedbackContainer');
            const q = allQuestions[currentQuestionIndex];
            const userAnswers = q.fields.map(f => document.getElementById(f.id).value.trim());
            
            const sortedUser = [...userAnswers].sort();
            const sortedCorrect = [...q.answers].sort();
            const isCorrect = JSON.stringify(sortedUser) === JSON.stringify(sortedCorrect);

            let feedbackHTML = `<div class="p-4 rounded-lg solution-box">`;
            if (isCorrect) {
                score++; // MODIFIED: Increment score if the answer is correct
                feedbackHTML += `<h3 class="text-lg font-bold text-green-700">Correct!</h3>`;
            } else {
                const userAnswerDisplay = userAnswers.map(a => a || "empty").join(', ');
                const correctAnswerDisplay = q.answers.join(', ');
                feedbackHTML += `<h3 class="text-lg font-bold text-red-700">Not quite.</h3>
                                 <p class="mt-1">Your answer was <strong>${userAnswerDisplay}</strong>. The correct answer is <strong>${correctAnswerDisplay}</strong>.</p>`;
            }
            
            feedbackHTML += `<div class="mt-4"><h4 class="font-semibold">Here's how to solve it:</h4><div class="mt-2 space-y-2 text-sm text-gray-700">${q.solutionSteps.join('<br>')}</div></div>`;
            feedbackHTML += `</div><div class="text-center mt-6">
                                <button id="nextBtn" class="bg-blue-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-blue-700">Next Question</button>
                             </div>`;
            
            feedbackContainer.innerHTML = feedbackHTML;
            document.getElementById('checkBtn').disabled = true;
            q.fields.forEach(f => document.getElementById(f.id).disabled = true);
            document.getElementById('nextBtn').addEventListener('click', nextQuestion);
            document.getElementById('nextBtn').focus();
        }

        function nextQuestion() {
            currentQuestionIndex++;
            renderCurrentQuestion();
        }
        
        document.addEventListener('DOMContentLoaded', startQuiz);
    </script>
</body>
</html>
