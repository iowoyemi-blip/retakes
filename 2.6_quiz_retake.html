<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solving Inequalities Practice | Step-by-Step</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Inter', sans-serif; }
        .solution-step {
            padding: 8px 12px;
            border-left: 3px solid #60a5fa; /* blue-400 */
            background-color: #f0f9ff; /* blue-50 */
            margin-top: 8px;
            border-radius: 0 4px 4px 0;
            font-family: 'Courier New', Courier, monospace;
        }
         .checkbox-label {
            display: flex;
            align-items: center;
            cursor: pointer;
            padding: 0.75rem;
            border-radius: 0.5rem;
            border: 1px solid #d1d5db;
            transition: all 0.2s;
        }
        .checkbox-label:has(input:checked) {
            background-color: #eff6ff;
            border-color: #3b82f6;
        }
        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen p-4">

    <main id="app" class="bg-white rounded-2xl shadow-lg w-full max-w-3xl transition-all duration-300">
        <div class="p-6 border-b border-gray-200">
            <h1 class="text-3xl font-bold text-gray-800">2.6 Quiz: Solving Inequalities</h1>
            <p class="text-gray-600 mt-2">Answer one question at a time to get immediate feedback.</p>
        </div>

        <div id="quizView" class="p-6 md:p-8">
            <div class="mb-6">
                <div class="flex justify-between mb-1">
                    <span id="progressText" class="text-base font-medium text-blue-700">Question 1 of 7</span>
                    <span id="scoreText" class="text-base font-medium text-blue-700">Score: 0/0</span>
                </div>
                <div class="w-full bg-gray-200 rounded-full h-2.5">
                    <div id="progressBar" class="bg-blue-600 h-2.5 rounded-full" style="width: 0%"></div>
                </div>
            </div>

            <div id="questionContainer"></div>

            <div id="feedbackContainer" class="mt-6 hidden"></div>
            
            <div id="navigationContainer" class="mt-8 text-center"></div>
        </div>

        <div id="resultsView" class="p-8 text-center hidden">
            <h2 class="text-3xl font-bold text-gray-800 mb-4">Quiz Complete!</h2>
            <div id="finalScore" class="text-2xl mb-2 font-semibold"></div>
            <p id="finalMessage" class="text-lg text-gray-600 mb-8"></p>
            <button id="generateNewBtn" class="bg-blue-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-4 focus:ring-blue-300 transition-transform transform hover:scale-105 w-full sm:w-auto">
                Generate New Quiz
            </button>
        </div>
    </main>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- DOM ELEMENTS ---
        const app = document.getElementById('app');
        const quizView = document.getElementById('quizView');
        const resultsView = document.getElementById('resultsView');
        const questionContainer = document.getElementById('questionContainer');
        const feedbackContainer = document.getElementById('feedbackContainer');
        const navigationContainer = document.getElementById('navigationContainer');
        const progressText = document.getElementById('progressText');
        const scoreText = document.getElementById('scoreText');
        const progressBar = document.getElementById('progressBar');
        const finalScore = document.getElementById('finalScore');
        const finalMessage = document.getElementById('finalMessage');
        const generateNewBtn = document.getElementById('generateNewBtn');

        // --- STATE ---
        let questions = [];
        let currentQuestionIndex = 0;
        let score = 0;

        // --- UTILITY FUNCTIONS ---
        const getRandomInt = (min, max) => Math.floor(Math.random() * (max - min + 1)) + min;
        const shuffle = (arr) => arr.sort(() => Math.random() - 0.5);
        const normalizeAnswer = (str) => str.replace(/\s+/g, '').toLowerCase().replace(/infinity/g, 'inf');

        // --- QUESTION GENERATION WITH SOLUTIONS ---
        function generateInequalityQuestions() {
            let qSet = [];
            const variable = shuffle(['x', 'p', 'k', 'm', 'n'])[0];
            let a, b, c, d, e, f, sol, sol2;

            // 1. Select all that apply
            const coeff1 = getRandomInt(2, 5) * -5;
            const boundary1 = getRandomInt(-5, 5);
            const result1 = coeff1 * boundary1;
            const checkFn1 = val => val > boundary1;
            const options1 = shuffle([
                boundary1, boundary1 - getRandomInt(1, 5), boundary1 - getRandomInt(6, 10),
                boundary1 + getRandomInt(1, 5), boundary1 + getRandomInt(6, 10)
            ]).sort((a,b)=>a-b);
            qSet.push({
                type: 'checkbox',
                text: `Select the values of the variable that make the given inequality true. [Select all that apply.]`,
                inequality: `${coeff1}${variable} < ${result1}`,
                options: options1,
                answers: options1.filter(checkFn1).map(String).sort(),
                solution: [
                    `First, solve the inequality for ${variable}`,
                    `Given: ${coeff1}${variable} < ${result1}`,
                    `Divide both sides by ${coeff1}. **Remember to flip the inequality sign** because we are dividing by a negative number.`,
                    `(${coeff1}${variable}) / ${coeff1} > ${result1} / ${coeff1}`,
                    `Solution: ${variable} > ${boundary1}`,
                    `Now, check which of the given options are greater than ${boundary1}. The correct values are: ${options1.filter(checkFn1).join(', ')}.`
                ]
            });

            // 2a. Two-step
            a = getRandomInt(2, 5); b = getRandomInt(1, 10);
            sol = getRandomInt(2, 8); c = a * sol + b;
            qSet.push({
                type: 'solve', text: `Solve: ${a}${variable} + ${b} > ${c}`,
                answers: { inequality: `${variable}>${sol}`, interval: `(${sol},inf)` },
                solution: [
                    `Given: ${a}${variable} + ${b} > ${c}`,
                    `Subtract ${b} from both sides: ${a}${variable} > ${c} - ${b}`,
                    `Simplify: ${a}${variable} > ${c-b}`,
                    `Divide by ${a}: ${variable} > ${c-b}/${a}`,
                    `Final Answer: ${variable} > ${sol}`
                ]
            });

            // 2b. Negative variable
            b = getRandomInt(1, 10); sol = getRandomInt(-10, -2); c = b + sol;
            qSet.push({
                type: 'solve', text: `Solve: ${c} - ${variable} >= ${b}`,
                answers: { inequality: `${variable}<=${sol}`, interval: `(-inf,${sol}]` },
                solution: [
                    `Given: ${c} - ${variable} >= ${b}`,
                    `Subtract ${c} from both sides: -${variable} >= ${b} - ${c}`,
                    `Simplify: -${variable} >= ${b-c}`,
                    `Multiply by -1. **Remember to flip the inequality sign.**`,
                    `Final Answer: ${variable} <= ${sol}`
                ]
            });

            // 2c. Variables on both sides
            a = getRandomInt(2, 5); b = getRandomInt(1, 10); c = getRandomInt(2, 5);
            sol = getRandomInt(-5, -1); d = (a + c) * sol - b;
            qSet.push({
                type: 'solve', text: `Solve: ${a}${variable} - ${b} < ${d} - ${c}${variable}`,
                answers: { inequality: `${variable}<${sol}`, interval: `(-inf,${sol})` },
                solution: [
                    `Given: ${a}${variable} - ${b} < ${d} - ${c}${variable}`,
                    `Add ${c}${variable} to both sides: ${a}${variable} + ${c}${variable} - ${b} < ${d}`,
                    `Simplify: ${a+c}${variable} - ${b} < ${d}`,
                    `Add ${b} to both sides: ${a+c}${variable} < ${d} + ${b}`,
                    `Simplify: ${a+c}${variable} < ${d+b}`,
                    `Divide by ${a+c}: ${variable} < ${d+b}/${a+c}`,
                    `Final Answer: ${variable} < ${sol}`
                ]
            });

             // 2d. Variables on both sides, negative coefficients
            a = getRandomInt(2, 5); b = getRandomInt(a + 2, 12); sol = getRandomInt(2, 8);
            c = getRandomInt(1, 15); d = (b - a) * sol + c;
            qSet.push({
                type: 'solve', text: `Solve: ${c} - ${a}${variable} <= ${d} - ${b}${variable}`,
                answers: { inequality: `${variable}<=${sol}`, interval: `(-inf,${sol}]` },
                solution: [
                    `Given: ${c} - ${a}${variable} <= ${d} - ${b}${variable}`,
                    `Add ${b}${variable} to both sides: ${c} - ${a}${variable} + ${b}${variable} <= ${d}`,
                    `Simplify: ${c} + ${b-a}${variable} <= ${d}`,
                    `Subtract ${c} from both sides: ${b-a}${variable} <= ${d} - ${c}`,
                    `Simplify: ${b-a}${variable} <= ${d-c}`,
                    `Divide by ${b-a}: ${variable} <= (${d-c})/(${b-a})`,
                    `Final Answer: ${variable} <= ${sol}`
                ]
            });
            
            // 2e. Compound AND
            a = getRandomInt(2, 5); b = getRandomInt(-5, 5);
            sol = getRandomInt(-5, 0); sol2 = getRandomInt(1, 5);
            c = a * sol + b; d = a * sol2 + b;
            const bSign = b >= 0 ? '+' : '-';
            const bVal = Math.abs(b);
            qSet.push({
                type: 'solve', text: `Solve: ${c} < ${a}${variable} ${bSign} ${bVal} < ${d}`,
                answers: { inequality: `${sol}<${variable}<${sol2}`, interval: `(${sol},${sol2})` },
                solution: [
                    `Given: ${c} < ${a}${variable} ${bSign} ${bVal} < ${d}`,
                    `To isolate the variable, perform the same operation on all three parts of the inequality.`,
                    b >= 0 ? `Subtract ${bVal} from all three parts.` : `Add ${bVal} to all three parts.`,
                    `${c - b} < ${a}${variable} < ${d - b}`,
                    `Divide all three parts by ${a}: ${c-b}/${a} < ${variable} < ${d-b}/${a}`,
                    `Final Answer: ${sol} < ${variable} < ${sol2}`
                ]
            });

            // 2f. Compound OR
            a = getRandomInt(2, 5); b = getRandomInt(5, 10); sol = getRandomInt(-10, -5) * a;
            c = (sol / a) - b;
            d = getRandomInt(2, 5); e = getRandomInt(1, 10); sol2 = getRandomInt(5, 10);
            f = e - (d * sol2);
            qSet.push({
                type: 'solve', text: `Solve: ${variable}/${a} - ${b} < ${c} or ${e} - ${d}${variable} <= ${f}`,
                answers: { inequality: `${variable}<${sol} or ${variable}>=${sol2}`, interval: `(-inf,${sol}) U [${sol2},inf)` },
                solution: [
                    `Solve each inequality separately.`,
                    `Part 1: ${variable}/${a} - ${b} < ${c}`,
                    `Add ${b} to both sides: ${variable}/${a} < ${c+b}`,
                    `Multiply by ${a}: ${variable} < ${sol}`,
                    `Part 2: ${e} - ${d}${variable} <= ${f}`,
                    `Subtract ${e} from both sides: -${d}${variable} <= ${f-e}`,
                    `Divide by -${d} and **flip the sign**: ${variable} >= (${f-e})/(-${d})`,
                    `Simplify: ${variable} >= ${sol2}`,
                    `Combine the solutions with "or": ${variable} < ${sol} or ${variable} >= ${sol2}`
                ]
            });

            return qSet;
        }


        // --- RENDERING & UI LOGIC ---
        function renderQuestion() {
            const q = questions[currentQuestionIndex];
            let contentHTML = '';

            if (q.type === 'checkbox') {
                contentHTML = `
                    <h2 class="text-xl font-semibold text-gray-700 mb-2">${q.text}</h2>
                    <p class="text-center text-2xl font-mono my-6 p-4 bg-gray-50 rounded-lg">${q.inequality}</p>
                    <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
                        ${q.options.map(opt => `
                            <label class="checkbox-label text-lg">
                                <input type="checkbox" name="q_option" value="${opt}" class="mr-3 h-5 w-5 rounded">
                                <span>${opt}</span>
                            </label>
                        `).join('')}
                    </div>`;
            } else if (q.type === 'solve') {
                contentHTML = `
                    <h2 class="text-xl font-semibold text-gray-700 mb-2">Solve the inequality and provide the solution in both notations.</h2>
                    <p class="text-center text-2xl font-mono my-6 p-4 bg-gray-50 rounded-lg">${q.text}</p>
                    <div class="space-y-4">
                        <input type="text" id="ineq_input" class="w-full p-3 border border-gray-300 rounded-lg text-lg" placeholder="Inequality notation (e.g., x>5)">
                        <input type="text" id="int_input" class="w-full p-3 border border-gray-300 rounded-lg text-lg" placeholder="Interval notation (e.g., (5,inf))">
                    </div>`;
            }
            questionContainer.innerHTML = contentHTML;
            navigationContainer.innerHTML = `<button id="checkAnswerBtn" class="bg-green-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-green-700 focus:outline-none focus:ring-4 focus:ring-green-300 transition-transform transform hover:scale-105">Check Answer</button>`;
            
            document.getElementById('checkAnswerBtn').addEventListener('click', checkAnswer);
            feedbackContainer.classList.add('hidden');
        }

        function updateProgress() {
            const totalQuestions = questions.length;
            const answeredCount = currentQuestionIndex;
            progressText.textContent = `Question ${currentQuestionIndex + 1} of ${totalQuestions}`;
            scoreText.textContent = `Score: ${score}/${answeredCount}`;
            progressBar.style.width = `${((currentQuestionIndex) / totalQuestions) * 100}%`;
        }

        function checkAnswer() {
            const q = questions[currentQuestionIndex];
            let isCorrect = false;
            let feedbackHTML = '';

            if (q.type === 'checkbox') {
                const userChecked = Array.from(document.querySelectorAll('input[name="q_option"]:checked')).map(cb => cb.value).sort();
                isCorrect = JSON.stringify(userChecked) === JSON.stringify(q.answers);
            } else if (q.type === 'solve') {
                const userIneq = normalizeAnswer(document.getElementById('ineq_input').value);
                const userInt = normalizeAnswer(document.getElementById('int_input').value);

                let normUserIneq = userIneq;
                if (normUserIneq.includes('or')) normUserIneq = normUserIneq.split('or').sort().join('or');
                
                let normAnsIneq = normalizeAnswer(q.answers.inequality);
                if (normAnsIneq.includes('or')) normAnsIneq = normAnsIneq.split('or').sort().join('or');
                
                isCorrect = (normUserIneq === normAnsIneq) && (userInt === normalizeAnswer(q.answers.interval));
            }

            if (isCorrect) {
                score++;
                feedbackHTML += `<div class="p-4 rounded-lg bg-green-100 border border-green-300 text-green-800">
                    <h3 class="font-bold text-lg">Correct! 🎉</h3>
                </div>`;
            } else {
                feedbackHTML += `<div class="p-4 rounded-lg bg-red-100 border border-red-300 text-red-800">
                    <h3 class="font-bold text-lg">Not quite. Here's the solution:</h3>
                </div>`;
            }

            // Solution steps
            feedbackHTML += `<div class="mt-4">
                <h4 class="font-semibold text-gray-700 text-lg mb-2">Step-by-Step Solution:</h4>
                ${q.solution.map(step => `<div class="solution-step">${step}</div>`).join('')}
            </div>`;
            
            feedbackContainer.innerHTML = feedbackHTML;
            feedbackContainer.classList.remove('hidden');

            questionContainer.querySelectorAll('input').forEach(input => input.disabled = true);
            
            navigationContainer.innerHTML = `<button id="nextQuestionBtn" class="bg-blue-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-blue-300 transition-transform transform hover:scale-105">Next Question &rarr;</button>`;
            document.getElementById('nextQuestionBtn').addEventListener('click', nextQuestion);
            
            scoreText.textContent = `Score: ${score}/${currentQuestionIndex + 1}`;
        }

        function nextQuestion() {
            currentQuestionIndex++;
             progressBar.style.width = `${((currentQuestionIndex) / questions.length) * 100}%`;

            if (currentQuestionIndex < questions.length) {
                updateProgress();
                renderQuestion();
            } else {
                showResults();
            }
        }
        
        function showResults() {
            quizView.classList.add('hidden');
            const percentage = Math.round((score / questions.length) * 100);
            
            let scoreColor;
            let message;

            if (percentage >= 90) {
                scoreColor = 'text-green-600';
                message = "Excellent work! You've mastered this topic.";
            } else if (percentage >= 70) {
                scoreColor = 'text-yellow-600';
                message = "Good job! A little more practice and you'll be an expert.";
            } else {
                scoreColor = 'text-red-600';
                message = "Keep practicing! Review the solutions and try a new quiz.";
            }

            finalScore.innerHTML = `Your Score: <span class="${scoreColor}">${score} out of ${questions.length} (${percentage}%)</span>`;
            finalMessage.textContent = message;
            resultsView.classList.remove('hidden');
        }

        function startQuiz() {
            questions = generateInequalityQuestions();
            currentQuestionIndex = 0;
            score = 0;

            resultsView.classList.add('hidden');
            quizView.classList.remove('hidden');
            
            updateProgress();
            renderQuestion();
        }

        // --- EVENT LISTENERS ---
        generateNewBtn.addEventListener('click', startQuiz);
        
        // --- INITIALIZE ---
        startQuiz();

    });
</script>

</body>
</html>
