<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solving Systems of Equations Algebraically</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .system-brace {
            font-size: 4rem;
            font-family: serif;
            margin-right: 0.5rem;
            line-height: 1;
        }
        .equation-system {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 1rem;
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen p-4">

    <main class="bg-white rounded-2xl shadow-lg w-full max-w-4xl">
        <div class="p-8 border-b border-gray-200">
            <h1 class="text-3xl font-bold text-gray-800">Solving Systems Algebraically</h1>
            <p class="text-gray-600 mt-2">Generate a new quiz anytime. Enter solutions as an ordered pair (x, y), "no solution", or "infinite solutions".</p>
        </div>

        <div id="quizContainer" class="p-8">
            <!-- The quiz form will be dynamically generated and inserted here -->
        </div>

        <!-- Results Section -->
        <div id="resultsSection" class="hidden p-8">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">Quiz Results</h2>
            <div id="score" class="text-xl mb-6 font-semibold"></div>
            <div id="detailedResults" class="space-y-4"></div>
             <div class="mt-8 text-center flex flex-col sm:flex-row justify-center items-center gap-4">
                <button id="retakeQuizBtn" class="bg-gray-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-gray-700">Try This Quiz Again</button>
                <button id="generateNewBtn" class="bg-blue-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-blue-700">Generate New Quiz</button>
            </div>
        </div>
    </main>

    <script>
        const quizContainer = document.getElementById('quizContainer');
        const resultsSection = document.getElementById('resultsSection');
        const scoreElement = document.getElementById('score');
        const detailedResultsElement = document.getElementById('detailedResults');
        const retakeQuizBtn = document.getElementById('retakeQuizBtn');
        const generateNewBtn = document.getElementById('generateNewBtn');

        let currentQuestions = [];

        const getRandomInt = (min, max) => Math.floor(Math.random() * (max - min + 1)) + min;

        function generateQuizData() {
            let questions = [];
            let x, y, a1, b1, c1, a2, b2, c2, m, b, k;

            // 1. Substitution (isolated variable)
            x = getRandomInt(-5, 5); y = getRandomInt(-5, 5);
            a1 = getRandomInt(-4, 4) || 1; b1 = getRandomInt(-4, 4) || 1;
            c1 = a1 * x + b1 * y;
            m = getRandomInt(-4, 4) || 1;
            b = y - m * x;
            questions.push({ id: 'q1', title: 'Solve the system by the substitution method:',
                eq1: `${a1}x + ${b1}y = ${c1}`, eq2: `y = ${m}x ${b>=0?'+':'-'} ${Math.abs(b)}`, answer: `(${x},${y})`
            });

            // 2. Substitution (no isolated variable)
            x = getRandomInt(-5, 5); y = getRandomInt(-5, 5);
            b1 = getRandomInt(2, 5) * (Math.random() > 0.5 ? 1 : -1);
            a1 = 1 * (Math.random() > 0.5 ? 1 : -1); // Force one coefficient to be 1 or -1
            c1 = a1 * x + b1 * y;
            a2 = getRandomInt(-4, 4) || 1; b2 = getRandomInt(-4, 4) || 1;
            c2 = a2 * x + b2 * y;
             questions.push({ id: 'q2', title: 'Solve the system by the substitution method:',
                eq1: `${a1}x + ${b1}y = ${c1}`, eq2: `${a2}x + ${b2}y = ${c2}`, answer: `(${x},${y})`
            });

            // 3. Elimination (addition)
            x = getRandomInt(-5, 5); y = getRandomInt(-5, 5);
            a1 = getRandomInt(-5, 5) || 1; b1 = getRandomInt(-5, 5) || 1;
            c1 = a1 * x + b1 * y;
            a2 = getRandomInt(-5, 5) || 1; b2 = -b1;
            c2 = a2 * x + b2 * y;
            questions.push({ id: 'q3', title: 'Solve the system by the Elimination method:',
                eq1: `${a1}x + ${b1}y = ${c1}`, eq2: `${a2}x + ${b2}y = ${c2}`, answer: `(${x},${y})`
            });

            // 4. Elimination (multiplication)
            x = getRandomInt(-3, 3); y = getRandomInt(-3, 3);
            a1 = getRandomInt(2, 5); b1 = getRandomInt(2, 5);
            a2 = getRandomInt(2, 5); b2 = getRandomInt(2, 5);
            if (a1 === a2) a2++; if (b1 === b2) b2++;
            c1 = a1 * x + b1 * y; c2 = a2 * x + b2 * y;
             questions.push({ id: 'q4', title: 'Solve the system by Elimination method:',
                eq1: `${a1}x + ${b1}y = ${c1}`, eq2: `${a2}x + ${b2}y = ${c2}`, answer: `(${x},${y})`
            });

            // 5 & 6. Special Cases
            const isNoSolutionFirst = Math.random() > 0.5;
            // No Solution
            a1 = getRandomInt(-5, 5) || 1; b1 = getRandomInt(-5, 5) || 1; c1 = getRandomInt(-10, 10);
            k = getRandomInt(2, 4);
            const noSolEq1 = `${a1}x + ${b1}y = ${c1}`;
            const noSolEq2 = `${a1*k}x + ${b1*k}y = ${c1*k + (getRandomInt(1,5) * (Math.random()>0.5?1:-1))}`;
            // Infinite Solutions
            a2 = getRandomInt(-5, 5) || 1; b2 = getRandomInt(-5, 5) || 1; c2 = getRandomInt(-10, 10);
            k = getRandomInt(2, 4);
            const infSolEq1 = `${a2}x + ${b2}y = ${c2}`;
            const infSolEq2 = `${a2*k}x + ${b2*k}y = ${c2*k}`;
            
            if (isNoSolutionFirst) {
                questions.push({ id: 'q5', title: 'Solve by any method:', eq1: noSolEq1, eq2: noSolEq2, answer: 'no solution' });
                questions.push({ id: 'q6', title: 'Solve by any method:', eq1: infSolEq1, eq2: infSolEq2, answer: 'infinite solutions' });
            } else {
                questions.push({ id: 'q5', title: 'Solve by any method:', eq1: infSolEq1, eq2: infSolEq2, answer: 'infinite solutions' });
                questions.push({ id: 'q6', title: 'Solve by any method:', eq1: noSolEq1, eq2: noSolEq2, answer: 'no solution' });
            }

            currentQuestions = questions;
        }
        
        function renderQuizForm() {
            let html = '<form id="quizForm">';
            currentQuestions.forEach(q => {
                html += `<div class="mb-10 text-center">
                            <h2 class="text-xl font-semibold text-gray-700 mb-4">${q.id.slice(1)}. ${q.title}</h2>
                            <div class="equation-system">
                                <span class="system-brace">{</span>
                                <div class="text-lg font-mono text-left">
                                    ${q.eq1.replace(/\+ -/g, '- ')}<br>${q.eq2.replace(/\+ -/g, '- ')}
                                </div>
                            </div>
                            <div>
                                <label for="${q.id}" class="sr-only">Solution</label>
                                <input type="text" id="${q.id}" class="p-2 border rounded-lg text-center" placeholder="Solution">
                            </div>
                         </div>`;
            });
            html += `<div class="mt-10 text-center"><button type="submit" class="bg-green-600 text-white font-bold py-3 px-8 rounded-lg">Grade My Quiz</button></div></form>`;
            quizContainer.innerHTML = html;
            document.getElementById('quizForm').addEventListener('submit', gradeQuiz);
        }

        const normalizeAnswer = str => {
            let s = str.replace(/\s+/g, '').toLowerCase();
            if (s.includes('inf')) return 'infinite solutions';
            if (s.includes('no') || s.includes('none')) return 'no solution';
            return s;
        }

        function gradeQuiz(event) {
            event.preventDefault();
            let score = 0, total = 0, resultsHTML = '';
            
            currentQuestions.forEach(q => {
                total++;
                const userInput = document.getElementById(q.id).value;
                const isCorrect = normalizeAnswer(userInput) === normalizeAnswer(q.answer);
                if (isCorrect) score++;
                resultsHTML += `<div class="p-4 border-l-4 ${isCorrect?'border-green-500 bg-green-50':'border-red-500 bg-red-50'}">
                    <p class="font-semibold">${q.id.slice(1)}. ${q.title}</p>
                    <p>Your Answer: ${userInput || 'none'}</p>
                    ${!isCorrect ? `<p>Correct Answer: ${q.answer}</p>` : ''}
                </div>`;
            });
            
            const percentage = total > 0 ? Math.round((score / total) * 100) : 0;
            let scoreColor = percentage >= 80 ? 'text-green-600' : (percentage >= 60 ? 'text-yellow-600' : 'text-red-600');
            scoreElement.innerHTML = `Your Score: <span class="${scoreColor}">${score} out of ${total} (${percentage}%)</span>`;
            detailedResultsElement.innerHTML = resultsHTML;
            quizContainer.classList.add('hidden');
            resultsSection.classList.remove('hidden');
            window.scrollTo(0, 0);
        }
        
        retakeQuizBtn.addEventListener('click', () => {
            renderQuizForm();
            resultsSection.classList.add('hidden');
            quizContainer.classList.remove('hidden');
        });
        generateNewBtn.addEventListener('click', () => {
            generateQuizData();
            renderQuizForm();
            resultsSection.classList.add('hidden');
            quizContainer.classList.remove('hidden');
        });
        document.addEventListener('DOMContentLoaded', () => {
             generateQuizData();
             renderQuizForm();
        });
    </script>
</body>
</html>

